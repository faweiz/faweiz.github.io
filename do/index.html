<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="devicehub.js"></script>
    <script>
        DeviceHubInit(5305,"fc4d8925-f54e-4f70-a035-c66bf863d055","670761ae-7469-4ca1-87c6-078d5ee17c73");
	sensor1=new Sensor("lightcontrol");
        actuator1=new Actuator("lightcontrol");
        function getSensorValue()
        {
            var data=sensor1.getData(); //get data from API

            //display data in tabel using JS
            var x=document.getElementById('sensor1');
            x.innerHTML=data['value'];
           // console.log(data['value']);
        }
        function getActuatorValue()
        {
            var data=actuator1.getState(); //get data from API

            //display data in tabel using JS
            var x=document.getElementById('actuator1');
            x.innerHTML=data['state'];
           // console.log(data['value']);
        }
        function changeSensorValue()
        {
            var x=document.getElementById('sensor1_value');
            console.log(x.value);
            sensor1.sendData(x.value);//send data to API
            location.reload(); // refresh page
        }
        function changeActuatorValue()
        {
            var x=document.getElementById('actuator1_value');
            console.log(x.value);
            actuator1.sendState(x.value);//send data to API
            location.reload(); // refresh page
        }
        function loadData()
        {
            getSensorValue();
            getActuatorValue();
        }
        
        function changeActuatorValue_on()
        {
            var x=document.getElementById("value1");;
            console.log(x.value);
      //      alert(x.innerHTML);
            actuator1.sendState(x.value);//send data to API
            location.reload(); // refresh page
        }
        function changeActuatorValue_off()
        {
            var x=document.getElementById("value0");;
            console.log(x.value);
      //      alert(x.innerHTML);
            actuator1.sendState(x.value);//send data to API
            location.reload(); // refresh page
        }
    </script>
    <script>
        var imgUrl = "https://faweiz.github.io/do/Do_on.jpg";
        var lineLink = "https://faweiz.github.io/do/";
        var descContent = '用DeviceHub链接YunLight控制圣诞灯的开关';
        var shareTitle = 'YunLight圣诞灯控制开关 ';
        var appid = '';
           
        function shareFriend() {
            WeixinJSBridge.invoke('sendAppMessage',{
                "appid": appid,
                "img_url": imgUrl,
                "img_width": "200",
                "img_height": "200",
                "link": lineLink,
                "desc": descContent,
                "title": shareTitle
            }, function(res) {
                //_report('send_msg', res.err_msg);
            })
        }
        function shareTimeline() {
            WeixinJSBridge.invoke('shareTimeline',{
                "img_url": imgUrl,
                "img_width": "200",
                "img_height": "200",
                "link": lineLink,
                "desc": descContent,
                "title": shareTitle
            }, function(res) {
                   //_report('timeline', res.err_msg);
            });
        }
        function shareWeibo() {
            WeixinJSBridge.invoke('shareWeibo',{
                "content": descContent,
                "url": lineLink,
            }, function(res) {
                //_report('weibo', res.err_msg);
            });
        }
        // 当微信内置浏览器完成内部初始化后会触发WeixinJSBridgeReady事件。
        document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
            // 发送给好友
            WeixinJSBridge.on('menu:share:appmessage', function(argv){
                shareFriend();
            });
            // 分享到朋友圈
            WeixinJSBridge.on('menu:share:timeline', function(argv){
                shareTimeline();
            });
            // 分享到微博
            WeixinJSBridge.on('menu:share:weibo', function(argv){
                shareWeibo();
            });
        }, false);
</script>
<!--	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1"> -->
	<title>YunLight DeviceHub</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script>
	$(document).ready(function(){
	    var n = 0;
	    $("input").select(function(){
	     if(n%2 == 0)
	        $("input").after(n+": ON ");
	     else
	        $("input").after(n+": OFF ");
	    });
	    $("img").click(function(){
	        $.post("https://maker.ifttt.com/trigger/yunlight/with/key/cfMURKOr7oZMGUh6pkMfl_");
	        $("input").trigger("select");
	    n++;
	    });
	});
	</script>
	
</head>
<body onload="loadData()">
	<center>
<!--	
	    <table>
	        <tr><td colspan="2"><h1>ON</h1></td></tr>
	        <tr><th>Value</th><td><span id="actuator1"></span></td></tr>
	        <tr><th>Change value</th><td><input type="text" id="value1" value="1"/></td></tr>
	        <tr><td colspan="2"><center><input type="image" alt="on it!" src="Do_on.jpg" onclick="changeActuatorValue_on()"/></center></td></tr>
	    </table>
	    <table>
	        <tr><td colspan="2"><h1>OFF</h1></td></tr>
	        <tr><th>Value</th><td><span id="actuator1"></span></td></tr>
	        <tr><th>Change value</th><td><input type="text" id="value0" value="0"/></tr>
	        <tr><td colspan="2"><center><input type="image" alt="off it!" src="Do_off.jpg" onclick="changeActuatorValue_off()"/></center></td></tr>
	    </table>

    	<h1>ON</h1>
    	<input type="hidden" id="value1" value="1" />
    	<input type="image" alt="on it!" src="Do_on.jpg" onclick="changeActuatorValue_on()"/>
    	<h1>OFF</h1>
    	<input type="hidden" id="value0" value="0"/>
    	<input type="image" alt="off it!" src="Do_off.jpg" onclick="changeActuatorValue_off()"/>
-->    	
	<img src="0.jpg" alt="Do it!"/>
	<h1>YunLight 圣诞灯控制开关</h1>
		<img src="Do_on.jpg" alt="Do it!" width="100%"/>
	</center>
	<h2><input type="hidden"/></h2><br><br>
</body>
</html>
